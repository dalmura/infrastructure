apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: fail2ban
spec:
  plugin:
    fail2ban:
      rules:
        enabled: true
        # Window size to look for failures
        findtime: "30m"

        # Sinbin duration
        bantime: "3h"

        # Max failures before into the sinbin
        maxretry: "4"

        # HTTP Response codes to count as failure
        statuscode: 400,401,403-499
